<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ’˜ Catch The Flying Hearts</title>
<link rel="stylesheet" href="../css/style.css">
<style>
body,html{margin:0;padding:0;font-family:"Poppins",sans-serif;}
#hearts-background{
  width:100%;min-height:100vh;background:linear-gradient(135deg,#ffe4ec,#ffc2db);
  position:relative; overflow:hidden;
}
#instructions{
  position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
  z-index:10; background:#fff0f5; border:2px solid #ffc2db;
  padding:35px 30px; border-radius:20px; text-align:center;
  max-width:380px; font-family:'Dancing Script',cursive;color:#6b216b;
}
#instructions h2{font-size:28px;margin-bottom:15px;}
#instructions p{font-size:18px;line-height:1.5;}
#startGame{margin-top:15px;padding:12px 25px;font-size:18px;border:none;border-radius:15px;background:#ff8fab;color:white;cursor:pointer;}
#startGame:hover{transform:scale(1.08);}
.blurred{filter:blur(5px);pointer-events:none;}
#basket{
  position:absolute; bottom:20px; left:50%; transform:translateX(-50%);
  width:80px;height:40px;background:#ff4d6d;border-radius:20px;
}
.heart{
  position:absolute;width:30px;height:30px;background:red;border-radius:50%;
}
#score{
  position:absolute; top:20px; left:50%; transform:translateX(-50%);
  font-size:22px; font-weight:bold; color:#6b216b;
}
#controls{position:absolute;top:20px;right:20px;display:flex;gap:10px;z-index:5;}
#controls button{padding:10px 15px;border-radius:10px;cursor:pointer;background:#d8b4fe;color:white;border:none;font-weight:600;}
#controls button:hover{transform:scale(1.05);}
#backBtn{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);}
</style>
</head>
<body>

<div id="game-container">
  <div id="hearts-background">
    <div id="score">Score: 0</div>
    <div id="basket"></div>
  </div>

  <!-- Instructions overlay -->
  <div id="instructions">
    <h2>ðŸ’– Catch The Flying Hearts ðŸ’–</h2>
    <p>Move the basket ðŸ§º left/right and catch the falling hearts ðŸ’˜ to score points!</p>
    <button id="startGame">Okay! ðŸ’—</button>
  </div>

  <!-- Controls & Back -->
  <div id="controls">
    <button id="pauseBtn">Pause</button>
    <button id="instructionsBtn">Instructions</button>
  </div>
  <button id="backBtn" onclick="window.location.href='../funzone.html'">â¬… Back</button>
</div>

<script src="../js/game-common.js"></script>
<script>
const background = document.getElementById('hearts-background');
const basket = document.getElementById('basket');
const scoreEl = document.getElementById('score');

let hearts=[], score=0, gamePaused=false, basketX=window.innerWidth/2-40;

function createHeart(){
  const heart=document.createElement('div');
  heart.classList.add('heart');
  heart.style.left=Math.random()*(window.innerWidth-30)+'px';
  heart.style.top='-30px';
  background.appendChild(heart);
  hearts.push(heart);
}

function moveBasket(e){
  if(gamePaused) return;
  basketX = e.touches ? e.touches[0].clientX-40 : e.clientX-40;
  if(basketX<0) basketX=0;
  if(basketX>window.innerWidth-80) basketX=window.innerWidth-80;
  basket.style.left=basketX+'px';
}

function updateHearts(){
  if(gamePaused) return;
  hearts.forEach((heart,i)=>{
    let top=parseFloat(heart.style.top);
    top+=3+Math.random()*2;
    heart.style.top=top+'px';
    // check collision
    const heartX=parseFloat(heart.style.left);
    const heartY=top;
    if(heartY+30>=window.innerHeight-60 && heartX+30>basketX && heartX<basketX+80){
      score+=1;
      scoreEl.innerText='Score: '+score;
      background.removeChild(heart);
      hearts.splice(i,1);
    } else if(top>window.innerHeight){
      background.removeChild(heart);
      hearts.splice(i,1);
    }
  });
  requestAnimationFrame(updateHearts);
}

function startHeartsGame(){
  document.getElementById('instructions').style.display='none';
  background.classList.remove('blurred');
  setInterval(createHeart,800);
  requestAnimationFrame(updateHearts);
}

background.addEventListener('mousemove',moveBasket);
background.addEventListener('touchmove',moveBasket);

document.getElementById('pauseBtn').addEventListener('click',()=>{
  gamePaused=!gamePaused;
  document.getElementById('pauseBtn').innerText=gamePaused?'Play':'Pause';
});

document.getElementById('instructionsBtn').addEventListener('click',()=>{
  document.getElementById('instructions').style.display='block';
  background.classList.add('blurred');
});

initGame('hearts-background', startHeartsGame);
</script>
</body>
</html>
